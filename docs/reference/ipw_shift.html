<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>IPW Estimates of the Causal Effects of Stochatic Shift Interventions — ipw_shift • haldensify</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="IPW Estimates of the Causal Effects of Stochatic Shift Interventions — ipw_shift" />
<meta property="og:description" content="IPW Estimates of the Causal Effects of Stochatic Shift Interventions" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">haldensify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro_haldensify.html">Highly Adaptive Lasso Conditional Density Estimation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nhejazi/haldensify/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>IPW Estimates of the Causal Effects of Stochatic Shift Interventions</h1>
    <small class="dont-index">Source: <a href='https://github.com/nhejazi/haldensify/blob/master/R/ipw_shift.R'><code>R/ipw_shift.R</code></a></small>
    <div class="hidden name"><code>ipw_shift.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>IPW Estimates of the Causal Effects of Stochatic Shift Interventions</p>
    </div>

    <pre class="usage"><span class='fu'>ipw_shift</span><span class='op'>(</span>
  <span class='va'>W</span>,
  <span class='va'>A</span>,
  <span class='va'>Y</span>,
  delta <span class='op'>=</span> <span class='fl'>0</span>,
  n_bins <span class='op'>=</span> <span class='fu'><a href='make_bins.html'>make_bins</a></span><span class='op'>(</span><span class='va'>A</span>, <span class='st'>"hist"</span><span class='op'>)</span>,
  cv_folds <span class='op'>=</span> <span class='fl'>10L</span>,
  <span class='va'>lambda_seq</span>,
  <span class='va'>...</span>,
  bin_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"equal_range"</span>, <span class='st'>"equal_mass"</span><span class='op'>)</span>,
  trim_density <span class='op'>=</span> <span class='cn'>FALSE</span>,
  undersmooth_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"dcar"</span>, <span class='st'>"plateau"</span>, <span class='st'>"gcv"</span>, <span class='st'>"all"</span><span class='op'>)</span>,
  bootstrap <span class='op'>=</span> <span class='cn'>FALSE</span>,
  n_boot <span class='op'>=</span> <span class='fl'>1000L</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>W</th>
      <td><p>A <code>matrix</code>, <code>data.frame</code>, or similar containing a set of
baseline covariates.</p></td>
    </tr>
    <tr>
      <th>A</th>
      <td><p>A <code>numeric</code> vector corresponding to a exposure variable. The
parameter of interest is defined as a location shift of this quantity.</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>A <code>numeric</code> vector of the observed outcomes.</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>A <code>numeric</code> value indicating the shift in the exposure to
be used in defining the target parameter. This is defined with respect to
the scale of the exposure (A).</p></td>
    </tr>
    <tr>
      <th>n_bins</th>
      <td><p>A <code>numeric</code>, scalar or vector, indicating the number of
bins into which the support of A is to be partitioned for constructing
conditional density estimates.</p></td>
    </tr>
    <tr>
      <th>cv_folds</th>
      <td><p>A <code>numeric</code> giving the number of folds to be used for
cross-validation. Note that this form of sample splitting is used for the
selection of tuning parameters by empirical risk minimization, not for the
estimation of nuisance parameters (i.e., to relax regularity conditions).</p></td>
    </tr>
    <tr>
      <th>lambda_seq</th>
      <td><p>A <code>numeric</code> sequence of the regularization parameter
(L1 norm of HAL coefficients) to be used in fitting HAL models.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments for model fitting to be passed directly to
<code><a href='haldensify.html'>haldensify</a></code>.</p></td>
    </tr>
    <tr>
      <th>bin_type</th>
      <td><p>A <code>character</code> indicating the strategy to be used in
creating bins along the observed support of <code>A</code>. For bins of equal
range, use <code>"equal_range"</code>; to ensure each bin has the same number of
observations, use instead <code>"equal_mass"</code>. For more information, see
documentation of <code>grid_type</code> in <code><a href='haldensify.html'>haldensify</a></code>.</p></td>
    </tr>
    <tr>
      <th>trim_density</th>
      <td><p>A <code>logical</code> indicating whether estimates of the
conditional density should be trimmed. Refer to the <code>trim</code> argument of
the <code>predict</code> method of <code>haldensify</code> for details. The default is
<code>FALSE</code> since propensity score truncation can lead to estimation bias.</p></td>
    </tr>
    <tr>
      <th>undersmooth_type</th>
      <td><p>A <code>character</code> indicating the selection strategy
to be used in identifying an efficent IPW estimator. The choices include
<code>"gcv"</code> for global cross-validation, <code>"dcar"</code> for solving the
IPW representation of the EIF through, and <code>"plateau"</code> for an approach
that balances changes in the parameter estimate and its mean squared error,
based on Lepski's method. The option <code>"all"</code> produces results based on
all three selection strategies, sharing redundant computation between each.</p></td>
    </tr>
    <tr>
      <th>bootstrap</th>
      <td><p>A <code>logical</code> indicating whether the estimator variance
should be approximated using the nonparametric bootstrap. The default is
<code>FALSE</code>, in which case the empirical variances of the IPW estimating
function and the EIF are used for for estimator selection and for variance
estimation, respectively. When set to <code>TRUE</code>, the bootstrap variance
is used for both of these purposes instead. Note that the bootstrap is very
computationally intensive and scales relatively poorly.</p></td>
    </tr>
    <tr>
      <th>n_boot</th>
      <td><p>A <code>numeric</code> giving the number of bootstrap re-samples to
be used in computing the mean squared error as part of the plateau selector
criterion. Ignored when <code>undersmooth_type</code> is not <code>"plateau"</code>.</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># simulate data</span>
<span class='va'>n_obs</span> <span class='op'>&lt;-</span> <span class='fl'>50</span>
<span class='va'>W1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='va'>n_obs</span>, <span class='fl'>1</span>, <span class='fl'>0.6</span><span class='op'>)</span>
<span class='va'>W2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='va'>n_obs</span>, <span class='fl'>1</span>, <span class='fl'>0.2</span><span class='op'>)</span>
<span class='va'>W3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Poisson.html'>rpois</a></span><span class='op'>(</span><span class='va'>n_obs</span>, <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n_obs</span>, <span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>W1</span> <span class='op'>-</span> <span class='va'>W2</span> <span class='op'>-</span> <span class='va'>W1</span> <span class='op'>*</span> <span class='va'>W2</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span><span class='va'>n_obs</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span><span class='op'>(</span><span class='fl'>3</span> <span class='op'>*</span> <span class='va'>A</span> <span class='op'>+</span> <span class='va'>W1</span> <span class='op'>+</span> <span class='va'>W2</span> <span class='op'>-</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>W3</span> <span class='op'>-</span> <span class='va'>W1</span> <span class='op'>*</span> <span class='va'>W3</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># fit the IPW estimator</span>
<span class='va'>est_ipw_shift</span> <span class='op'>&lt;-</span> <span class='fu'>ipw_shift</span><span class='op'>(</span>
  W <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>W1</span>, <span class='va'>W2</span>, <span class='va'>W3</span><span class='op'>)</span>, A <span class='op'>=</span> <span class='va'>A</span>, Y <span class='op'>=</span> <span class='va'>Y</span>, delta <span class='op'>=</span> <span class='fl'>0.5</span>,
  lambda_seq <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>10</span>, length <span class='op'>=</span> <span class='fl'>500L</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='co'># arguments passed to hal9001::fit_hal()</span>
  max_degree <span class='op'>=</span> <span class='fl'>3</span>,
  smoothness_orders <span class='op'>=</span> <span class='fl'>0</span>,
  num_knots <span class='op'>=</span> <span class='cn'>NULL</span>,
  reduce_basis <span class='op'>=</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>n_obs</span><span class='op'>)</span>,
  <span class='co'># ...continue arguments for IPW</span>
  undersmooth_type <span class='op'>=</span> <span class='st'>"dcar"</span>
<span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nima Hejazi, David Benkeser, Mark van der Laan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


